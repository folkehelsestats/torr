% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cannabis-pop.R
\name{create_cann_pop}
\alias{create_cann_pop}
\title{Create Cannabis Population Indicators}
\usage{
create_cann_pop(dt, types = c("ltp", "lyp", "lmp"), vars, value = "cannabis")
}
\arguments{
\item{dt}{A data.table or data.frame containing the substance use variables.}

\item{types}{A character vector specifying which indicators to create.
Must contain one or more of: "ltp" (lifetime), "lyp" (last year), "lmp" (last month).
Default is \code{c("ltp", "lyp", "lmp")} to create all three indicators.
The order and content of \code{types} must match the order and content of \code{vars}.}

\item{vars}{A character vector containing variable names corresponding to \code{types}.
\itemize{
\item If types = "ltp", provide 1 variable (lifetime use)
\item If types = c("ltp", "lyp"), provide 2 variables (lifetime, last year)
\item If types = c("ltp", "lyp", "lmp"), provide 3 variables (lifetime, last year, last month)
}
Variables should be coded where 1-2 indicate use.}

\item{value}{A character string to use as a suffix for the created variables.
Default is "cannabis".}
}
\value{
A data.table with additional columns based on \code{types}:
\describe{
\item{ltpPop_\{value\}}{Lifetime population indicator (1 = ever used, 0 = never)}
\item{lypPop_\{value\}}{Last year population indicator (1 = used in past year, 0 = no)}
\item{lmpPop_\{value\}}{Last month population indicator (1 = used in past month, 0 = no)}
}
}
\description{
Creates binary population indicators based on lifetime, last year, and/or
last month substance use variables. The function generates columns indicating
whether individuals have ever used, used in the past year, or used in the
past month. Users can specify which indicators to create.
}
\details{
The function creates cascading indicators:
\itemize{
\item \strong{Lifetime (ltp):} 1 if lifetime use variable is 1 or 2
\item \strong{Last year (lyp):} 1 if last year variable is 1-2, OR if lifetime variable is 2
\item \strong{Last month (lmp):} 1 if last month variable is 1-2, OR if last year variable is 2,
OR if lifetime variable is 2
}

The cascading logic means:
\itemize{
\item To create "lyp", you must also include "ltp" in types
\item To create "lmp", you must also include both "ltp" and "lyp" in types
}
}
\note{
The input data.table is copied to avoid modifying by reference. Missing values
are handled as FALSE (coded as 0) in all conditions.
}
\examples{
\dontrun{
library(data.table)

# Create sample data
dt <- data.table(
  id = 1:5,
  lifetime_use = c(1, 2, 3, 1, NA),
  year_use = c(1, 2, 3, 2, 1),
  month_use = c(1, 3, 3, 1, 2)
)

# Create all three indicators (default)
result <- create_cann_pop(
  dt = dt,
  vars = c("lifetime_use", "year_use", "month_use"),
  value = "cannabis"
)

# Create only lifetime indicator
result <- create_cann_pop(
  dt = dt,
  types = "ltp",
  vars = "lifetime_use",
  value = "cannabis"
)

# Create lifetime and last year indicators
result <- create_cann_pop(
  dt = dt,
  types = c("ltp", "lyp"),
  vars = c("lifetime_use", "year_use"),
  value = "cannabis"
)

# With different substance
result <- create_cann_pop(
  dt = dt,
  types = c("ltp", "lyp", "lmp"),
  vars = c("lifetime_use", "year_use", "month_use"),
  value = "alcohol"
)
}

}
